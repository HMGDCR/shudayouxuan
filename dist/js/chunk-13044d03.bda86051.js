(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13044d03"],{"2fdb":function(t,e,a){"use strict";var i=a("5ca1"),o=a("d2c8"),s="includes";i(i.P+i.F*a("5147")(s),"String",{includes:function(t){return!!~o(this,t,s).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"3bc2":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("\n         电影"+t._s(t.isAdd?"添加":"编辑")+"   \n     ")]),a("div",[a("el-form",{ref:"form",staticClass:"main-content",attrs:{model:t.movieData,"label-width":"80px"}},[a("div",{staticClass:"filmInfo"},[a("el-form-item",{attrs:{label:"电影名称"}},[a("el-input",{attrs:{placeholder:"请输入电影名称"},model:{value:t.movieData.name,callback:function(e){t.$set(t.movieData,"name",e)},expression:"movieData.name"}})],1),t.isAdd?t._e():a("el-form-item",{attrs:{label:"电影ID"}},[a("el-input",{attrs:{placeholder:"",disabled:""},model:{value:t.movieData.filmId,callback:function(e){t.$set(t.movieData,"filmId",e)},expression:"movieData.filmId"}})],1),a("el-form-item",{attrs:{label:"内容分类"}},[a("el-input",{attrs:{placeholder:"内容分类"},model:{value:t.movieData.category,callback:function(e){t.$set(t.movieData,"category",e)},expression:"movieData.category"}})],1),a("el-form-item",{attrs:{label:"导演"}},[a("el-input",{attrs:{placeholder:"导演"},model:{value:t.movieData.director,callback:function(e){t.$set(t.movieData,"director",e)},expression:"movieData.director"}})],1),a("el-form-item",{attrs:{label:"上映时间"}},[a("el-date-picker",{staticClass:"timePicker",attrs:{type:"date",placeholder:"选择日期"},model:{value:t.movieData.premiereAt,callback:function(e){t.$set(t.movieData,"premiereAt",e)},expression:"movieData.premiereAt"}})],1),a("el-form-item",{attrs:{label:"评分"}},[a("el-input",{attrs:{placeholder:"评分"},model:{value:t.movieData.grade,callback:function(e){t.$set(t.movieData,"grade",e)},expression:"movieData.grade"}})],1),a("el-form-item",{attrs:{label:"语言"}},[a("el-input",{attrs:{placeholder:"语言"},model:{value:t.movieData.language,callback:function(e){t.$set(t.movieData,"language",e)},expression:"movieData.language"}})],1),a("el-form-item",{attrs:{label:"时长"}},[a("el-input",{attrs:{placeholder:"时长"},model:{value:t.movieData.runtime,callback:function(e){t.$set(t.movieData,"runtime",e)},expression:"movieData.runtime"}})],1),a("el-form-item",{attrs:{label:"产地"}},[a("el-input",{attrs:{placeholder:"产地"},model:{value:t.movieData.nation,callback:function(e){t.$set(t.movieData,"nation",e)},expression:"movieData.nation"}})],1),a("el-form-item",{attrs:{label:"电影类型"}},[a("el-input",{attrs:{placeholder:"电影类型"},model:{value:t.movieData.filmType,callback:function(e){t.$set(t.movieData,"filmType",e)},expression:"movieData.filmType"}})],1),a("el-form-item",{attrs:{label:"简介"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.movieData.synopsis,callback:function(e){t.$set(t.movieData,"synopsis",e)},expression:"movieData.synopsis"}})],1),a("div",{staticClass:"switchButton"},[a("el-form-item",{staticClass:"onSale",attrs:{label:"在售"}},[a("el-switch",{attrs:{"active-text":t.movieData.isSale?"是":"否"},on:{change:t.isSaleState},model:{value:t.movieData.isSale,callback:function(e){t.$set(t.movieData,"isSale",e)},expression:"movieData.isSale"}})],1),a("el-form-item",{staticClass:"preSell",attrs:{label:"预售"}},[a("el-switch",{attrs:{"active-text":t.movieData.isPresale?"是":"否"},on:{change:t.isPresaleState},model:{value:t.movieData.isPresale,callback:function(e){t.$set(t.movieData,"isPresale",e)},expression:"movieData.isPresale"}})],1)],1),a("div",{staticClass:"poster-photo"},[a("el-form-item",{staticClass:"poster",attrs:{label:"海报"}},[a("Poster",{on:{sonData:t.getChildData,imgUplLoadState:t.imgUpload}})],1),a("el-form-item",{attrs:{label:"剧照"}},[a("el-upload",{ref:"upload",attrs:{action:"http://122.51.25.152:3000/admin/film/upload","list-type":"picture-card","on-preview":t.handlePreviewPhoto,"on-success":t.photoUpload,"on-change":t.handChange,"file-list":t.movieData.photos,"on-remove":t.handleRemovePhoto,"auto-upload":!0}},[a("i",{staticClass:"el-icon-plus"})]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)],1)],1),a("el-form-item",{staticClass:"add-submit"},[a("el-button",{attrs:{type:"primary",loading:t.loading,disabled:!!t.isAdd&&t.imgUpdateState},on:{click:t.onSubmit}},[t._v("立即"+t._s(t.isAdd?"添加":"编辑"))]),a("el-button",{nativeOn:{click:function(e){return t.clearAll(e)}}},[t._v("取消")])],1)],1)],1)])},o=[],s=(a("6762"),a("2fdb"),a("7f7f"),a("ac6a"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{action:"http://132.232.87.95:3000/admin/film/upload","show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"auto-upload":!0}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])}),l=[],r={data:function(){return{imageUrl:""}},mounted:function(){},methods:{handleAvatarSuccess:function(t,e){this.imageUrl=t.image.url,this.$emit("imgUplLoadState",!1)},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,a=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),a||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&a}},watch:{imageUrl:function(t,e){this.$emit("sonData",t),this.imageUrl=t},"$store.state.posterDefault":function(t,e){this.imageUrl=t},"$store.state.clearPosterFlag":function(t,e){console.log(t),this.imageUrl=""}}},n=r,c=(a("4443"),a("2877")),m=Object(c["a"])(n,s,l,!1,null,null,null),u=m.exports,d={components:{Poster:u},data:function(){return{imageUrl:"",imgUpdateState:!0,loading:!1,dialogImageUrl:"",dialogVisible:!1,disabled:!1,movieData:{category:"凄凄切切群",director:"啊啊啊啊啊啊啊啊",premiereAt:"1310572800000",name:"111111",update:"08-13 20:30:08",photos:[],actors:[{name:"算得上是",role:" 是s",avatarAddress:"",key:1565685916282}],poster:"",grade:"1",language:" 少时诵诗书",filmId:"5d517927eaa375006cdbdc6b",runtime:"asdfg",filmType:"2D",isPresale:!1,timeType:"",isSale:!0,synopsis:"s",nation:" 2222"},photosArr:[]}},created:function(){if(this.isAdd)return!1;this.$route.params.filmId,this.getFilmDetail(this.$route.params.filmId)},methods:{getFilmDetail:function(t){var e=this,a="/film/getDetail?filmId="+t;this.$axios.get(a).then((function(t){e.movieData=t.film,e.photosArr=t.film.photos,e.$store.commit("posterToChild",e.movieData.poster)})).catch((function(t){console.log(t)}))},imgUpload:function(t){this.imgUpdateState=t},handleRemovePhoto:function(t,e){var a=this;this.movieData.photos.forEach((function(e,i){e.url==t.url&&a.movieData.photos.splice(i,1)}))},handlePreviewPhoto:function(t){},photoUpload:function(t,e,a){this.photosArr.push({name:e.name,url:e.response.image.url})},handChange:function(t,e){},getChildData:function(t){this.movieData.poster=t},isSaleState:function(t){this.movieData.isPresale=!this.movieData.isSale},isPresaleState:function(t){this.movieData.isSale=!this.movieData.isPresale},onSubmit:function(){var t=this;this.loading=!0;var e="".concat(this.isAdd?"/film/add":"/film/edit"),a=this.movieData;this.$axios.post(e,a).then((function(e){t.$message.success("电影".concat(t.isAdd?"添加":"修改","成功！")),t.loading=!1,t.isAdd||t.$router.push("/movie/list")})).catch((function(e){t.$message.error(e),t.loading=!1}))},clearAll:function(){this.$store.commit("changeClearPosterFlag"),this.movieData={},this.isAdd||this.$router.push("/movie/list")}},computed:{isAdd:function(){return this.$route.path.includes("add")}},watch:{$route:{handler:function(t,e){console.log(t),"/movie/add"==t.path&&(this.movieData={},this.$store.commit("posterToChild",""))},deep:!0,immediate:!0},photosArr:{handler:function(t,e){this.movieData["photos"]=this.photosArr,console.log(t)},deep:!0,immediate:!0}}},p=d,f=(a("dec7"),a("e7ba"),Object(c["a"])(p,i,o,!1,null,"6a72473b",null));e["default"]=f.exports},4443:function(t,e,a){"use strict";var i=a("a765"),o=a.n(i);o.a},5147:function(t,e,a){var i=a("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,!"/./"[t](e)}catch(o){}}return!0}},6762:function(t,e,a){"use strict";var i=a("5ca1"),o=a("c366")(!0);i(i.P,"Array",{includes:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"7f7f":function(t,e,a){var i=a("86cc").f,o=Function.prototype,s=/^\s*function ([^ (]*)/,l="name";l in o||a("9e1e")&&i(o,l,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(t){return""}}})},"8e5b":function(t,e,a){},a765:function(t,e,a){},aae3:function(t,e,a){var i=a("d3f4"),o=a("2d95"),s=a("2b4c")("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==o(t))}},ac6a:function(t,e,a){for(var i=a("cadf"),o=a("0d58"),s=a("2aba"),l=a("7726"),r=a("32e9"),n=a("84f2"),c=a("2b4c"),m=c("iterator"),u=c("toStringTag"),d=n.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=o(p),h=0;h<f.length;h++){var v,g=f[h],D=p[g],b=l[g],S=b&&b.prototype;if(S&&(S[m]||r(S,m,d),S[u]||r(S,u,g),n[g]=d,D))for(v in i)S[v]||s(S,v,i[v],!0)}},d2c8:function(t,e,a){var i=a("aae3"),o=a("be13");t.exports=function(t,e,a){if(i(e))throw TypeError("String#"+a+" doesn't accept regex!");return String(o(t))}},dec7:function(t,e,a){"use strict";var i=a("8e5b"),o=a.n(i);o.a},e3e4:function(t,e,a){},e7ba:function(t,e,a){"use strict";var i=a("e3e4"),o=a.n(i);o.a}}]);
//# sourceMappingURL=chunk-13044d03.bda86051.js.map